define(["Ti/_/css","Ti/_/declare","Ti/_/dom","Ti/_/event","Ti/_/lang","Ti/_/style","Ti/_/Evented","Ti/UI","Ti/UI/Animation"],function(t,e,i,n,o,r,a,s,c){var l=window,u=i.unitize,d=i.computeSize,h=require.on,_=r.set,f=require.is,p=o.isDef,g={post:"_doBackground"},m=function(t,e){return(null===t||!f(t,"String")&&!f(t,"Number"))&&(t=void 0),t!==e&&!this._batchUpdateInProgress&&this._triggerLayout(),t},v={set:m},T="px",b="ontouchstart"in l;return e("Ti._.UI.Element",a,{domType:null,domNode:null,_alive:1,constructor:function(){var e=this,o=0;e.domNode=e._setFocusNode(i.create(e.domType||"div",{className:"TiUIElement "+t.clean(e.declaredClass),"data-widget-id":e.widgetId})),e._children=[],h(e,"touchstart",e,"_doBackground"),h(e,"touchend",e,"_doBackground"),h(e.domNode,b?"touchstart":"mousedown",function(t){var i=[h(l,b?"touchmove":"mousemove",function(t){(b||o)&&(t._elements||(t._elements=[])).push(e)}),h(l,b?"touchend":"mouseup",function(t){o=0,(t._elements||(t._elements=[])).push(e),n.off(i)}),b&&h(l,"touchcancel",function(t){(t._elements||(t._elements=[])).push(e),n.off(i)})];o=1,(t._elements||(t._elements=[])).push(e)});var r=e.constants.__values__;e._layoutCoefficients={width:{x1:0,x2:0,x3:0},minWidth:{x1:0,x2:0,x3:0},sandboxWidth:{x1:0,x2:0,x3:0},height:{x1:0,x2:0,x3:0},minHeight:{x1:0,x2:0,x3:0},sandboxHeight:{x1:0,x2:0,x3:0},left:{x1:0,x2:0,x3:0},top:{x1:0,x2:0,x3:0,x4:0}},r.size={x:0,y:0,width:0,height:0},r.rect={x:0,y:0,width:0,height:0}},fireEvent:function(t,e){e=e||{};var i,n=e.bubbles;a.fireEvent.call(this,t,e),n&&!e.cancelBubble&&this.bubbleParent&&this._parent&&(p(e.x)&&(i=this.convertPointToView({x:e.x,y:e.y},this._parent),e.x=i?i.x:e.x,e.y=i?i.y:e.y),this._parent.fireEvent(t,e))},_setParent:function(t){this._parent=t},_add:function(t,e){t._hidden=e,t._setParent(this),this._children.push(t),this.containerNode.appendChild(t.domNode),t._triggerLayout()},_insertAt:function(t,e,i){var n=this._children;e>n.length||0>e||(e===n.length?this._add(t,i):(t._parent=this,this.containerNode.insertBefore(t.domNode,n[e].domNode),n.splice(e,0,t),this._triggerLayout()))},_remove:function(t){var e=this._children,n=e.indexOf(t);-1!==n&&(e.splice(n,1),t._setParent(),i.detach(t.domNode),this._triggerLayout())},_removeAllChildren:function(){for(var t=this._children;t.length;)this.remove(t[0]);this._triggerLayout()},destroy:function(){if(this._alive){for(var t=this._children;t.length;)t.splice(0,1)[0].destroy();this._parent&&this._parent._remove(this),this.domNode&&(i.destroy(this.domNode),this.domNode=null)}a.destroy.apply(this,arguments)},_isAttachedToActiveWin:function(){for(var t=!1,e=this;e;){if(e===s._container){t=!0;break}e=e._parent}return t},_needsMeasuring:!0,_triggerLayout:function(t){this._needsMeasuring=!0,this._isAttachedToActiveWin()&&(!this._batchUpdateInProgress||t)&&s._triggerLayout(this,t)},_hasSizeDimensions:function(){return this._hasSizeWidth()||this._hasSizeHeight()},_hasSizeHeight:function(){return isNaN(this._layoutCoefficients.height.x1)},_hasSizeWidth:function(){return isNaN(this._layoutCoefficients.width.x1)},startLayout:function(){this._batchUpdateInProgress=!0},finishLayout:function(){this._batchUpdateInProgress=!1,s._triggerLayout(this,!0)},updateLayout:function(t){this.startLayout();for(var e=0,i=t.length;i>e;e++)this[e]=t[e];this.finishLayout()},convertPointToView:function(t,e){function i(t,e,i){for(var n=e.x,o=e.y,r=i?1:-1;t;)n+=r*t.domNode.offsetLeft,o+=r*t.domNode.offsetTop,t=t._parent;return{x:n,y:o}}if(!this._isAttachedToActiveWin()||!e._isAttachedToActiveWin())return null;if(!t||!f(t.x,"Number")||!f(t.y,"Number"))throw Error("Invalid point");if(!e.domNode)throw Error("Invalid destination view");return i(e,i(this,t,!0),!1)},_getContentOffset:function(){return{x:0,y:0}},_computeGradient:function(){var t=this.backgroundGradient;colors=t.colors,type=t.type,cssVal=type+"-gradient(";var e=d(t.startPoint.x,this._measuredWidth),i=d(t.startPoint.y,this._measuredHeight),n=d("50%",this._measuredWidth),o=d("50%",this._measuredHeight),r=colors.length;if("linear"===type){var a,s,c=d(t.endPoint.x,this._measuredWidth),l=d(t.endPoint.y,this._measuredHeight);if(.01>Math.abs(e-c))l>i?(a=i,s=l,cssVal+="270deg"):(a=l,s=i,cssVal+="90deg");else if(.01>Math.abs(i-l))c>e?(a=e,s=c,cssVal+="0deg"):(a=c,s=e,cssVal+="180deg");else{var u=!1;if(e>c){u=!0;var h=e;e=c,c=h,h=i,i=l,l=h}var p=Math.atan2(l-i,c-e);if(tanAngle=Math.tan(p),cosAngle=Math.cos(p),originLineIntersection=o-n*tanAngle,userDistance=(i-e*tanAngle-originLineIntersection)*cosAngle,userXOffset=userDistance*Math.sin(p),userYOffset=userDistance*cosAngle,e+=userXOffset,i-=userYOffset,c+=userXOffset,l-=userYOffset,shiftedAngle=Math.PI/2-p,p>0){var g=originLineIntersection*Math.sin(shiftedAngle),m=-g*Math.cos(shiftedAngle),v=g*Math.sin(shiftedAngle);a=Math.sqrt(Math.pow(e-m,2)+Math.pow(i-v,2)),s=Math.sqrt(Math.pow(c-m,2)+Math.pow(l-v,2))}else{var g=(this._measuredHeight-originLineIntersection)*Math.sin(shiftedAngle),m=-g*Math.cos(shiftedAngle),v=this._measuredHeight-g*Math.sin(shiftedAngle);a=Math.sqrt(Math.pow(e-m,2)+Math.pow(i-v,2)),s=Math.sqrt(Math.pow(c-m,2)+Math.pow(l-v,2))}p=u?p+Math.PI:p,cssVal+=Math.round(360*(2*Math.PI-p)/(2*Math.PI))+"deg"}for(var b=0;r>b;b++){var y=colors[b];f(y,"String")&&(y={color:y}),f(y.offset,"Number")||(y.offset=b/(r-1)),cssVal+=","+y.color+" "+Math.round(d(100*y.offset+"%",s-a)+a)+T}}else if("radial"===type){var w=Math.min(this._measuredWidth,this._measuredHeight),I=d(t.startRadius,w),E=d(t.endRadius,w),x=[],u=!1;if(I>E){var h=I;I=E,E=h,u=!0;for(var b=0;(r-2)/2>=b;b++){var S=r-b-1;x[b]=colors[S],x[S]=colors[b]}if(1===r%2){var N=Math.floor(r/2);x[N]=colors[N]}}else for(var b=0;r>b;b++)x[b]=colors[b];cssVal+=e+T+" "+i+T;for(var b=0;r>b;b++){var y=x[b];f(y,"String")&&(y={color:y});var C;C=f(y.offset,"Number")?u?1===r%2&&b===Math.floor(r/2)?y.offset:1-y.offset:y.offset:b/(r-1),cssVal+=","+y.color+" "+Math.round(d(100*C+"%",E-I)+I)+T}}require.config.vendorPrefixes.css.forEach(function(t){_(this.domNode,"backgroundImage",t+cssVal+")")},this)},_defaultBackgroundColor:void 0,_defaultBackgroundImage:void 0,_defaultBackgroundDisabledColor:void 0,_defaultBackgroundDisabledImage:void 0,_defaultBackgroundFocusedColor:void 0,_defaultBackgroundFocusedImage:void 0,_defaultBackgroundSelectedColor:void 0,_defaultBackgroundSelectedImage:void 0,_borderLeftWidth:0,_borderRightWidth:0,_borderTopWidth:0,_borderBottomWidth:0,_getBorderFromCSS:function(){setTimeout(o.hitch(this,function(){var t=l.getComputedStyle(this.domNode),e=parseInt(t["border-left-width"]),i=parseInt(t["border-right-width"]),n=parseInt(t["border-top-width"]),o=parseInt(t["border-bottom-width"]);isNaN(e)||isNaN(i)||isNaN(n)||isNaN(o)||(this.borderWidth=e===i&&e===n&&e===o?e:[e,i,n,o])}),1)},_doBackground:function(t){if(!this.backgroundGradient){t=t||{};var e,i=(t.type||"").match(/mouse(over|out)/),n=this.backgroundImage||this._defaultBackgroundImage||"none",o=this.backgroundColor||this._defaultBackgroundColor,a=this.backgroundRepeat,s=this.domNode.style;this._touching&&(o=this.backgroundSelectedColor||this._defaultBackgroundSelectedColor||o,n=this.backgroundSelectedImage||this._defaultBackgroundSelectedImage||n),i&&(this._over="over"===i[1]),!this._touching&&this.focusable&&this._over&&(o=this.backgroundFocusedColor||this._defaultBackgroundFocusedColor||o,n=this.backgroundFocusedImage||this._defaultBackgroundFocusedImage||n),this.enabled||(o=this.backgroundDisabledColor||this._defaultBackgroundDisabledColor||o,n=this.backgroundDisabledImage||this._defaultBackgroundDisabledImage||n),o=o||(n&&"none"!==n?"transparent":""),s.backgroundColor.toLowerCase()!==o.toLowerCase()&&(s.backgroundColor=o),n=r.url(n),s.backgroundImage.replace(/'|"/g,"").toLowerCase()!==n.toLowerCase()&&(s.backgroundImage=n),n&&(e=a?"repeat":"no-repeat",s.backgroundRepeat!==e&&(s.backgroundRepeat=e),e=a?"auto":"100% 100%",s.backgroundSize.replace(/(100%) 100%/,"$1")!==e&&(s.backgroundSize=e))}},_setFocusNode:function(t){var e=this._focus=this._focus||{};return e.node!==t&&(e.node&&(n.off(e.evts),n.off(e.evtsMore)),e.node=t,e.evts=[h(t,"focus",this,"_doBackground"),h(t,"blur",this,"_doBackground")]),t},show:function(){this.visible=!0},hide:function(){this.visible=!1},animate:function(t,e){return this._isAttachedToActiveWin()&&c._play(this,t&&"Ti.UI.Animation"===t.declaredClass?t:new c(t)).then(e)},_setTouchEnabled:function(t){var e,i=this._children,n=0,o=i.length;for(_(this.domNode,"pointerEvents",t?"auto":"none");o>n;n++)e=i[n],e._setTouchEnabled(t&&e.touchEnabled)},_measuredLeft:0,_measuredTop:0,_measuredWidth:0,_measuredHeight:0,_measuredSandboxWidth:0,_measuredSandboxHeight:0,constants:{size:{get:function(){return{x:0,y:0,width:this._measuredWidth,height:this._measuredHeight}}},rect:{get:function(){return{x:this._measuredLeft,y:this._measuredTop,width:this._measuredWidth,height:this._measuredHeight}}},parent:function(){return this._parent}},properties:{backgroundColor:g,backgroundDisabledColor:g,backgroundDisabledImage:g,backgroundFocusedColor:g,backgroundFocusedImage:g,backgroundGradient:{set:function(t){if(f(t.type,"String")&&f(t.colors,"Array")&&!(2>t.colors.length)){var e=t.type,i=t.startPoint,n=t.endPoint;if("linear"===e)i&&"x"in i&&"y"in i||(t.startPoint={x:"0%",y:"50%"}),n&&"x"in n&&"y"in n||(t.endPoint={x:"100%",y:"50%"});else{if("radial"!==e)return;i&&"x"in i&&"y"in i||(t.startPoint={x:"50%",y:"50%"})}return t}},post:function(){this.backgroundGradient&&this._computeGradient()}},backgroundImage:g,backgroundRepeat:g,backgroundSelectedColor:g,backgroundSelectedImage:g,borderColor:{set:function(t){return _(this.domNode,"borderColor",t),t}},borderRadius:{set:function(t){return _(this.domNode,"borderRadius",u(t)),t},value:0},borderWidth:{set:function(t,e){if(f(t,"Array")){if(4!==t.length)return e;_(this.domNode,{borderLeftWidth:(this._borderLeftWidth=t[0])+T,borderRightWidth:(this._borderRightWidth=t[1])+T,borderTopWidth:(this._borderTopWidth=t[2])+T,borderBottomWidth:(this._borderBottomWidth=t[3])+T}),this._borderSet=!0}else{if(isNaN(t))return e;_(this.domNode,"borderWidth",t+T),this._borderLeftWidth=this._borderRightWidth=this._borderTopWidth=this._borderBottomWidth=t,this._borderSet=!0}return t},post:m,value:0},bottom:v,bubbleParent:!0,center:v,color:{set:function(t){return _(this.domNode,"color",t)}},enabled:{post:"_doBackground",set:function(t){return this._focus.node.disabled=!t,t},value:!0},focusable:{value:!1,set:function(t){return i.attr[t?"set":"remove"](this._focus.node,"tabindex",0),t}},_minHeight:v,_maxHeight:v,height:v,left:v,opacity:{set:function(t){return _(this.domNode,"opacity",t)}},visible:{set:function(t,e){return t=!!t,t!==e&&(!t&&(this._lastDisplay=r.get(this.domNode,"display")),_(this.domNode,"display",t?this._lastDisplay||"":"none"),t&&void 0!==e&&this._triggerLayout()),t}},right:v,touchEnabled:{set:function(t){return this._setTouchEnabled(t),t},value:!0},top:v,transform:{set:function(t){return _(this.domNode,"transform",t&&t.toCSS()),this._curTransform=t}},_minWidth:v,_maxWidth:v,width:v,zIndex:v}})});