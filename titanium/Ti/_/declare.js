define(["Ti/_","Ti/_/lang"],function(t,e){function i(t,e){for(var i,n,o,a,l,u,d,h,_=[],f=[{cls:0,refs:[]}],g={},p=1,m=t.length,v=0;m>v;++v){if(o=t[v],!o)throw Error('Unknown base class for "'+e+'" ['+v+"]");if(s(o,"Object"))o=t[v]=r(o);else if(!s(o,"Function"))throw Error('Base class not a function for "'+e+'" ['+v+"]");for(n=o._meta?o._meta.bases:[o],a=0,i=n.length-1;i>=0;--i)l=n[i].prototype,l.hasOwnProperty("declaredClass")||(l.declaredClass="uniqName_"+c++),d=l.declaredClass,g.hasOwnProperty(d)||(g[d]={count:0,refs:[],cls:n[i]},++p),u=g[d],a&&a!==u&&(u.refs.push(a),++a.count),a=u;++a.count,f[0].refs.push(a)}for(;f.length;){for(a=f.pop(),_.push(a.cls),--p;h=a.refs,1==h.length;){if(a=h[0],!a||--a.count){a=0;break}_.push(a.cls),--p}if(a)for(v=0,m=h.length;m>v;++v)a=h[v],--a.count||f.push(a)}if(p)throw Error("Can't build consistent linearization for \""+e+'"');return o=t[0],_[0]=o?o._meta&&o===_[_.length-o._meta.bases.length]?o._meta.bases.length:1:0,_}function n(t,i){return function(){var n,r,o,a,l=arguments,c=l,h=l[0],_=t.length,f=this.declaredClass;if(f&&(u[f]||(u[f]=0),this.widgetId=f+":"+u[f]++),i&&(h&&h.preamble||this.preamble))for(a=Array(t.length),a[0]=l,r=0;(h=l[0])&&(n=h.preamble)&&(l=n.apply(this,l)||l),n=t[r].prototype,n=n.hasOwnProperty("preamble")&&n.preamble,n&&(l=n.apply(this,l)||l),++r!==_;)a[r]=l;for(r=_-1;r>=0;--r)n=t[r],o=n._meta,o&&(n=o.ctor,e.mixProps(this,o.hidden)),s(n,"Function")&&n.apply(this,a?a[r]:l);if(s(h,"Object")){n=this.constants;for(r in h)h.hasOwnProperty(r)&&((n&&r in n?n.__values__:this)[r]=h[r])}this.toString===d.toString&&(this.toString=function(){return"[object "+(f?f.replace(/\./g,""):"Object")+"]"}),n=this.postscript,n&&n.apply(this,c)}}function r(t){var e=Function();return l(e.prototype,t),e._meta={bases:[e],hidden:t},e}function o(t,e){for(var i in e)e.hasOwnProperty(i)&&!/^(constructor|properties|constants|__values__)$/.test(i)&&(s(e[i],"Function")&&(e[i].nom=name),t[i]=e[i]);return t}function a(t,a,c){s(t,"String")||(c=a,a=t,t=""),c=c||{};var u,h,_,f=[c.constructor],g=1,p={},m=s(a);if("Array"===m?(f=i(a,t),a=f[g=f.length-f[0]]):"Function"===m?(_=a._meta,f=f.concat(_?_.bases:a)):"Object"===m?f[1]=a=r(a):a=0,a)for(h=g-1;u=Function(),u.prototype=a.prototype,p=new u,h;--h)_=f[h],(_._meta?o:l)(p,_.prototype),u=Function(),u.superclass=a,u.prototype=p,a=p.constructor=u;return o(p,c),_=c.constructor,_!==d.constructor&&(_.nom="constructor",p.constructor=_),l(f[0]=u=n(f,_),{_meta:{bases:f,hidden:c,ctor:c.constructor},superclass:a&&a.prototype,extend:function(t){return o(this.prototype,t),this},prototype:p}),l(p,{constructor:u,isInstanceOf:function(t){for(var e=this.constructor._meta.bases,i=0,n=e.length;n>i;++i)if(e[i]===t)return!0;return this instanceof t}}),t&&(p.declaredClass=t,e.setObject(t,u)),u}var s=require.is,l=require.mix,c=0,u={},d=Object.prototype;return t.declare=a});