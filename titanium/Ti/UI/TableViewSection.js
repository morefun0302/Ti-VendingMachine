define(["Ti/_/declare","Ti/_/lang","Ti/_/UI/Widget","Ti/_/style","Ti/UI/MobileWeb/TableViewSeparatorStyle","Ti/UI"],function(t,e,i,n,r,o){var a=require.is,s=n.set,c=/(click|singletap|longpress)/;return t("Ti.UI.TableViewSection",i,{constructor:function(){this._indexedContent=[];for(var t=0,e=3,i=["_header","_rows","_footer"];e>t;)this._add(this[i[t++]]=o.createView({height:o.SIZE,width:o.INHERIT,layout:o._LAYOUT_CONSTRAINING_VERTICAL}));this.layout=o._LAYOUT_CONSTRAINING_VERTICAL},_defaultWidth:o.INHERIT,_defaultHeight:o.SIZE,fireEvent:function(t){c.test(t)&&this._tableView&&(this._tableView._tableViewSectionClicked=this),i.prototype.fireEvent.apply(this,arguments)},_tableView:null,_createSeparator:function(){var t=this._tableView&&this._tableView.separatorStyle===r.SINGLE_LINE,e=o.createView({height:t?1:0,width:o.INHERIT,backgroundColor:t?this._tableView.separatorColor:"transparent"});return s(e.domNode,"minWidth","100%"),e},_createDecorationLabel:function(t){return o.createLabel({text:t,backgroundColor:"darkGrey",color:"white",width:o.INHERIT,height:o.SIZE,left:0,font:{fontSize:18}})},_refreshRows:function(){if(this._tableView){var t,e,i=this._rows._children,n=this._tableView,o=this.constants.rows=[];for(t=1;i.length>t;t+=2)e=i[t],e._defaultHeight=n.rowHeight,e._minHeight=n.minRowHeight,e._maxHeight=n.maxRowHeight,o.push(e);for(t=0;i.length>t;t+=2)e=i[t],n.separatorStyle===r.SINGLE_LINE?(e.height=1,e.backgroundColor=n.separatorColor):(e.height=0,e.backgroundColor="transparent")}},_insertHelper:function(t,i){e.isDef(t.declaredClass)&&"Ti.UI.TableViewRow"==t.declaredClass||(t=o.createTableViewRow(t)),this._rows._insertAt(t,2*i+1),this._rows._insertAt(this._createSeparator(),2*i+2),t._tableViewSection=this,this.rowCount++,this._refreshRows()},add:function(t,i){var n=this._rows._children,r=this.rowCount;if(e.isDef(i)||(i=r),!(0>i||i>r))if(0===n.length&&this._rows._add(this._createSeparator()),a(t,"Array"))for(var o in t)this._insertHelper(t[o],i++);else this._insertHelper(t,i)},_removeAt:function(t){0>t||t>=this.rowCount||(this._rows._children[2*t+1]._tableViewSection=null,this._rows.remove(this._rows._children[2*t+1]),this._rows.remove(this._rows._children[2*t+1]),1===this._rows._children.length&&this._rows.remove(this._rows._children[0]),this._refreshRows())},remove:function(t){var e=this._rows._children.indexOf(t);-1!==e&&this._removeAt(e)},constants:{rows:void 0},properties:{footerTitle:{set:function(t,e){return e!=t&&(this._footer._removeAllChildren(),this._footer._add(this._createDecorationLabel(t)),this._footer._add(this._createSeparator())),t}},footerView:{set:function(t,e){return e!=t&&(this._footer._removeAllChildren(),this._footer._add(t)),t}},headerTitle:{set:function(t,e){return e!=t&&(this._header._removeAllChildren(),this._header._add(this._createDecorationLabel(t)),this._header._add(this._createSeparator())),t}},headerView:{set:function(t,e){return e!=t&&(this._header._removeAllChildren(),this._header._add(t)),t}},rowCount:function(){return Math.floor(this._rows._children.length/2)}}})});