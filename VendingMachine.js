function VendingMachine(){return 0==this instanceof VendingMachine?new VendingMachine:void 0}function insertCoin(n){return Ti.API.info("Inserting coin: "+n),_.contains(coinDenominations,n)?coinBalance=(parseFloat(coinBalance)+parseFloat(n)).toFixed(2):alert("invalid coin inserted"),coinBalance}function ejectCoins(){return coinBalance=0}function bankCoin(){}function giveChange(){}function addStock(n,e){var i=_.find(stock,function(e){return n===e.name});i.qty+=e}function removeStock(n,e){var i=_.find(stock,function(e){return n===e.name});i.qty-=e}var modes={VEND:"vend",STOCK:"stock"},activeMode,currency="GBP",coinDenominations=[.01,.02,.05,.1,.2,.5,1,2],coinBalance=0,stock=[{name:"Sweets",qty:10,price:.8},{name:"Crisps",qty:0,price:.85},{name:"Cakes",qty:10,price:1.25},{name:"Bottles",qty:10,price:1.45},{name:"Cans",qty:10,price:.95}];VendingMachine.prototype.modes=modes,VendingMachine.prototype.switchMode=function(n){switch(n){case modes.VEND:activeMode=n;break;case modes.STOCK:activeMode=n;break;default:alert("invalid mode set")}},VendingMachine.prototype.vend=function(n,e,i){var o=_.find(stock,function(e){return n===e.name});return 1>o.qty?(i({message:"Out of stock"}),!1):o.price>coinBalance?(i({message:"Please insert more coins to make this purchase"}),!1):(removeStock(n,1),coinBalance=(coinBalance-o.price).toFixed(2),e(coinBalance,stock),void 0)},VendingMachine.prototype.coin={insert:insertCoin,eject:ejectCoins,balance:function(){return coinBalance}()},VendingMachine.prototype.stock={add:addStock,remove:removeStock,levels:function(){return stock}()},module.exports=VendingMachine;